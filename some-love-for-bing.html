<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>Some Love for Bing</title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="" rel="canonical"/>
<!-- Feed -->
<link href="/theme/css/style.css" rel="stylesheet" type="text/css"/>
<!-- Code highlight color scheme -->
<link href="/theme/css/code_blocks/c3.css" rel="stylesheet"/>
<!-- CSS specified by the user -->
<link href="//home/ed/Documents/Code/PA2/attila/static/css/my_colors.css" rel="stylesheet" type="text/css">
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css"/>
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<link href="/some-love-for-bing.html" rel="canonical"/>
<meta content="How to automatically set the Bing homepage photo as your Linux desktop background each day." name="description"/>
<meta content="Edward Antonian" name="author"/>
<meta content="pelican" name="tags"/>
<meta content="Bing" name="tags"/>
<meta content="Wallpapers" name="tags"/>
<meta content="Python" name="tags"/>
<meta content="" property="og:locale">
<meta content="But is it Data Science?" property="og:site_name">
<meta content="website" property="og:type">
<meta content="But is it Data Science?" property="og:title">
<meta content="View the blog." property="og:description">
<meta content="" property="og:url">
<meta content="/images/covers/chaos.gif" property="og:image"/>
<meta content="article" property="og:type"/>
<meta content="/author/edward-antonian.html" property="article:author"/>
<meta content="/some-love-for-bing.html" property="og:url"/>
<meta content="Some Love for Bing" property="og:title"/>
<meta content="2019-05-31 00:00:00+01:00" property="article:published_time"/>
<meta content="How to automatically set the Bing homepage photo as your Linux desktop background each day." property="og:description"/>
<meta content="/images/covers/chaos.gif" property="og:image"/>
</meta></meta></meta></meta></meta></meta></link></meta></head>
<!-- TODO : Body class -->
<body class="home-template">
<nav id="menu">
<a class="close-button">Close</a>
<div class="nav-wrapper">
<p class="nav-label">Menu</p>
<ul><li role="presentation"><a href="pages/about.html">About</a></li><li role="presentation"><a href="archives.html">Archive</a></li><li role="presentation"><a href="pages/but-is-it-data-science.html">But is it?</a></li>
</ul>
</div>
</nav>
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="has-cover" id="post-header">
<div class="inner">
<nav id="navigation">
<span class="nav-button" id="home-button">
<a class="home-button" href="index.html" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
</span>
<span class="nav-button" id="menu-button">
<a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
</span>
</nav>
<h1 class="post-title">Some Love for Bing</h1>
<!-- TODO : Proper class for headline -->
<span class="post-meta">
<a href="/author/edward-antonian.html">Edward antonian</a>
            | <time datetime="Fri 31 May 2019">Fri 31 May 2019</time>
</span>
<!-- TODO : Modified check -->
<span class="post-meta"> | Updated on Fri 31 May 2019</span>
<div class="post-cover cover" style="background-image: url('images/covers/bing.jpg')">
</div>
</div></header>
<section id="wrapper">
<a class="hidden-close"></a>
<!-- Post content -->
<main class="content" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<h1>Some Love for Bing</h1>
<h2>"I don't know, let's Bing it"</h2>
<p>Bing. It's the search engine everyone loves to hate. But if there's one thing you have to give it credit for, they really do have some lovely background pictures. Here I just want to give a really quick tutorial on how you can automatically set the Bing picture of the day as your Linux desktop screen saver using python 2.7. (I know, I know, legacy python blah blah I'm a bad person, I just need a particular module which comes in the standard library for 2.7). I took some inspiration from <a href="https://github.com/UtkarshGpta/bing-desktop-wallpaper-changer">this repo</a>, but personally it didn't really work on my system and kept failing with weird errors, so I figured I'd try and write it from scratch. </p>
<p>First, set the folder where you want to save the image to.</p>
<div class="highlight"><pre><span></span><span class="n">SAVE_FILES_TO</span> <span class="o">=</span> <span class="s1">'/home/ed/Pictures/BingWallpapers'</span>
</pre></div>
<p>Next, fetch the URL for the photo of the day.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="kn">as</span> <span class="nn">ET</span>

<span class="k">def</span> <span class="nf">get_image</span><span class="p">():</span>
    <span class="sd">'''</span>
<span class="sd">    Return the name and url for the Bing photo of the day</span>
<span class="sd">    '''</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s1">'https://www.bing.com/HPImageArchive.aspx?format=xml&amp;idx=0&amp;n=1&amp;mkt=uk'</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">xml</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">'image'</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">'https://www.bing.com'</span> <span class="o">+</span> <span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"url"</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"startdate"</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">".jpg"</span>

    <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">url</span>
</pre></div>
<p>Now save this image to the directory you specified.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">urlretrieve</span>

<span class="k">def</span> <span class="nf">save_image</span><span class="p">():</span>
    <span class="sd">'''</span>
<span class="sd">    Save the image of the day to your wallpapers folder</span>
<span class="sd">    '''</span>
    <span class="n">name</span><span class="p">,</span> <span class="n">url</span> <span class="o">=</span> <span class="n">get_image</span><span class="p">()</span>
    <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SAVE_FILES_TO</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">SAVE_FILES_TO</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">SAVE_FILES_TO</span> <span class="o">+</span> <span class="s1">': This directory does not exist'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">image_path</span><span class="p">):</span>
        <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span><span class="p">,</span> <span class="n">image_path</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">'File exists already'</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span><span class="p">,</span> <span class="n">image_path</span>
</pre></div>
<p>Here's a few helper functions that will set the background and screensaver. </p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gi</span>
<span class="n">gi</span><span class="o">.</span><span class="n">require_version</span><span class="p">(</span><span class="s1">'Gtk'</span><span class="p">,</span> <span class="s1">'3.0'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gio</span>

<span class="k">def</span> <span class="nf">set_gsettings</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">gsettings</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">'org.gnome.desktop'</span> <span class="o">+</span> <span class="n">typ</span><span class="p">)</span>
    <span class="n">gsettings</span><span class="o">.</span><span class="n">set_string</span><span class="p">(</span><span class="s1">'picture-uri'</span><span class="p">,</span> <span class="s1">'file://'</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">gsettings</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">change_background</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">set_gsettings</span><span class="p">(</span><span class="s1">'background'</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">change_screensaver</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">set_gsettings</span><span class="p">(</span><span class="s1">'screensaver'</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>
<p>Now our main function just sets these, if it hasn't done so already</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">success</span><span class="p">,</span> <span class="n">image_path</span> <span class="o">=</span> <span class="n">save_image</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="n">change_background</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">change_screensaver</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</pre></div>
<p>Finally, a little loop to wait for an internet connection</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="s1">'www.google.com'</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
            <span class="n">main</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">'Retrying'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'Connection Failed'</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</pre></div>
<p>Now, to make this script automatically change the screen saver each day, just navigate to Startup Applications (in Ubuntu), make a new entry, and set the command to <code>python2 path/to/BingWallpapers.py</code> </p>
<p>And we're done! Would you look at that. </p>
<p><img alt="failed" src="images/bing.png"/></p>
<p><img alt="failed" src="images/bing2.jpg"/></p>
<p><img alt="failed" src="images/bing3.jpg"/></p>
<p><img alt="failed" src="images/bing4.jpg"/></p>
</section>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://but-is-it-data-science.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<section class="post-info">
<div class="post-share">
<a class="twitter" href="https://twitter.com/share?text=Some Love for Bing&amp;url=/some-love-for-bing.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
<i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
</a>
<a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=/some-love-for-bing.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
<i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
</a>
<a class="googleplus" href="https://plus.google.com/share?url=/some-love-for-bing.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
<i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="/tag/pelican.html">pelican</a><a href="/tag/bing.html">Bing</a><a href="/tag/wallpapers.html">Wallpapers</a><a href="/tag/python.html">Python</a> </aside>
<div class="clear"></div>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<!-- TODO : Body class -->
<div class="" id="body-class" style="display: none;"></div>
<footer id="footer">
<div class="inner">
<section class="credits">
<span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
<span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
</section>
</div>
</footer>
</section>
<script src="/theme/js/script.js" type="text/javascript"></script>
</body>
</html>