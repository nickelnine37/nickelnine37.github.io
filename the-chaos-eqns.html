<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta charset="utf-8" content="text/html" http-equiv="Content-Type"/>
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
   <title>
    The Chaos Equations
   </title>
   <meta content="True" name="HandheldFriendly"/>
   <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
   <meta content="origin" name="referrer"/>
   <meta content="Pelican" name="generator"/>
   <link href="" rel="canonical"/>
   <!-- Feed -->
   <link href="/theme/css/style.css" rel="stylesheet" type="text/css"/>
   <!-- Code highlight color scheme -->
   <link href="/theme/css/code_blocks/c3.css" rel="stylesheet"/>
   <!-- CSS specified by the user -->
   <link href="//home/ed/Documents/Code/PA2/attila/static/css/my_colors.css" rel="stylesheet" type="text/css"/>
   <!-- Custom fonts -->
   <link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
    <link href="/the-chaos-eqns.html" rel="canonical"/>
    <meta content="Some mathematical beauty to distract you from your impending doom" name="description"/>
    <meta content="Edward Antonian" name="author"/>
    <meta content="maths" name="tags"/>
    <meta content="chaos" name="tags"/>
    <meta content="python" name="tags"/>
    <meta content="pygame" name="tags"/>
    <meta content="animation" name="tags"/>
    <meta content="" property="og:locale"/>
    <meta content="But is it Data Science?" property="og:site_name"/>
    <meta content="website" property="og:type"/>
    <meta content="But is it Data Science?" property="og:title"/>
    <meta content="View the blog." property="og:description"/>
    <meta content="" property="og:url"/>
    <meta content="/images/covers/chaos.gif" property="og:image"/>
    <meta content="article" property="og:type">
     <meta content="/author/edward-antonian.html" property="article:author">
      <meta content="/the-chaos-eqns.html" property="og:url">
       <meta content="The Chaos Equations" property="og:title">
        <meta content="2020-03-15 00:00:00+00:00" property="article:published_time">
         <meta content="Some mathematical beauty to distract you from your impending doom" property="og:description">
          <meta content="/images/covers/chaos.gif" property="og:image">
          </meta>
         </meta>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </link>
  </meta>
 </head>
 <!-- TODO : Body class -->
 <body class="home-template">
  <nav id="menu">
   <a class="close-button">
    Close
   </a>
   <div class="nav-wrapper">
    <p class="nav-label">
     Menu
    </p>
    <ul>
     <li role="presentation">
      <a href="pages/about.html">
       About
      </a>
     </li>
     <li role="presentation">
      <a href="archives.html">
       Archive
      </a>
     </li>
     <li role="presentation">
     </li>
    </ul>
   </div>
  </nav>
  <!-- Progressbar -->
  <div class="progress-container">
   <span class="progress-bar">
   </span>
  </div>
  <!-- Page Header -->
  <!-- Set your background image for this header on the line below. -->
  <header class="has-cover" id="post-header">
   <div class="inner">
    <nav id="navigation">
     <span class="nav-button" id="home-button">
      <a class="home-button" href="index.html" title="Home">
       <i class="ic ic-arrow-left">
       </i>
       Home
      </a>
     </span>
     <span class="nav-button" id="menu-button">
      <a class="menu-button">
       <i class="ic ic-menu">
       </i>
       Menu
      </a>
     </span>
    </nav>
    <h1 class="post-title">
     The Chaos Equations
    </h1>
    <!-- TODO : Proper class for headline -->
    <span class="post-meta">
     <a href="/author/edward-antonian.html">
      Edward antonian
     </a>
     |
     <time datetime="Sun 15 March 2020">
      Sun 15 March 2020
     </time>
    </span>
    <!-- TODO : Modified check -->
    <span class="post-meta">
     | Updated on Sun 15 March 2020
    </span>
    <div class="post-cover cover" style="background-image: url('images/covers/chaos.gif')">
    </div>
   </div>
  </header>
  <section id="wrapper">
   <a class="hidden-close">
   </a>
   <!-- Post content -->
   <main class="content" role="main">
    <article class="post">
     <div class="inner">
      <section class="post-content">
       <h1 id="the-chaos-equations">
        The Chaos Equations
       </h1>
       <p>
        Dear all,
       </p>
       <p>
        These are tough times. The world seems to be crashing all around us. And while there's not a lot we can do save from making sure the people that matter the most to us are feel safe and supported, perhaps the nerdier among us can take some small comfort in the beauty of maths.
       </p>
       <p>
        Enter the chaos equations.
       </p>
       <p>
        The chaos equations are a set of surprisingly simple rules for updating points on a screen over time. When you make small changes to the way these rules are formulated, you get radically different and beautiful animations out the other side. Before I go into any explanation, check out the video below (weed optional).
       </p>
       <p>
        <em>
         Disclaimer: the original idea is ripped straight from
         <a href="https://www.youtube.com/watch?v=fDSIRXmnVvk">
          this guy
         </a>
         , who incidentally does a better job than me at making the animations look just gorgeous. However, his source code is written in pure c++: nobody has time for that. I wanted to write a really simply Python version that anybody can run in a regular python environment.
        </em>
       </p>
       <video controls="" height="480" width="640">
        <source src="images/colored_world.mp4" type="video/mp4"/>
       </video>
       <p>
        <em>
         Song credit
         <a href="https://kolbywade.bandcamp.com/album/inkblot-test">
          Colored World by Kolby Wade
         </a>
        </em>
        .
       </p>
       <p>
        To create these animations we need to keep track of three variables,
        <span class="math">
         \(x, y\)
        </span>
        and
        <span class="math">
         \(t\)
        </span>
        . The first two,
        <span class="math">
         \(x\)
        </span>
        and
        <span class="math">
         \(y\)
        </span>
        will represent the coordinates of a single point on the screen, and the third
        <span class="math">
         \(t\)
        </span>
        will represent time as the animation progresses. We start at some time
        <span class="math">
         \(t_1\)
        </span>
        , which usually pays to be between roughly
        <span class="math">
         \(-2\)
        </span>
        and
        <span class="math">
         \(2\)
        </span>
        . We then discretely increase time across
        <span class="math">
         \(N\)
        </span>
        time steps to
        <span class="math">
         \(t_N\)
        </span>
        , also usually between about
        <span class="math">
         \(-2\)
        </span>
        and
        <span class="math">
         \(2\)
        </span>
        . At the
        <span class="math">
         \(n\)
        </span>
        -th time step, we iterate an equation
        <span class="math">
         \(M\)
        </span>
        times to get
        <span class="math">
         \(M\)
        </span>
        pairs of coordinates
        <span class="math">
         \((x_i, y_i)\)
        </span>
        , which we can plot in a variety of colours. The update equation is as follows:
       </p>
       <div class="math">
        $$
\begin{align}
x_{k+1} = f(x_k, \, y_k, \, t_n) \\
y_{k+1} = g(x_k, \, y_k, \, t_n) 
\end{align}
$$
       </div>
       <p>
        with the initial condition that
       </p>
       <div class="math">
        $$
x_1 = t_n \\
y_1 = t_n
$$
       </div>
       <p>
        The choice of equations
        <span class="math">
         \(f(\cdot )\)
        </span>
        and
        <span class="math">
         \(g(\cdot )\)
        </span>
        are what gives rise to the different animations. Any update equations will do, although just simple polynomials seem to create great results. The only other things to choose are the times to run between and the number of iterations to perform.
       </p>
       <p>
        For those more computationally, minded, an equivalent formulation in pseudo-code would be
       </p>
       <div class="highlight">
        <pre><span></span><span class="k">for</span> <span class="nv">t</span> <span class="nv">from</span> <span class="nv">t0</span> <span class="nv">to</span> <span class="nv">tn</span>:
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">from</span> <span class="mi">1</span> <span class="nv">to</span> <span class="nv">M</span>:
        <span class="k">if</span> <span class="nv">i</span> <span class="o">==</span> <span class="mi">1</span>:
            <span class="nv">x_i</span>, <span class="nv">y_i</span> <span class="o">=</span> <span class="nv">t</span>, <span class="nv">t</span>
        <span class="k">else</span>:
            <span class="nv">x_i</span>, <span class="nv">y_i</span> <span class="o">=</span> <span class="nv">f</span><span class="ss">(</span><span class="nv">x_i</span>, <span class="nv">y_i</span>, <span class="nv">t</span><span class="ss">)</span>, <span class="nv">g</span><span class="ss">(</span><span class="nv">x_i</span>, <span class="nv">y_i</span>, <span class="nv">t</span><span class="ss">)</span>       
</pre>
       </div>
       <p>
        That's literally it! There's nothing more to it. Just give a different colour to each iteration, plot and watch the results.
       </p>
       <p>
        In order to implement this in Python, I used the popular library Pygame. I wanted to make it easy to explore these animations so I added an axis and the ability to pan and zoom. Check out the sporadically docstring-ed code below.
       </p>
       <div class="highlight">
        <pre><span></span><span class="kn">import</span> <span class="nn">pygame</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pygame</span> <span class="kn">import</span> <span class="n">gfxdraw</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Normalize</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="kn">as</span> <span class="nn">mpl_colors</span>


<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">mpl_colors</span><span class="o">.</span><span class="n">CSS4_COLORS</span><span class="p">,</span> <span class="o">**</span><span class="n">mpl_colors</span><span class="o">.</span><span class="n">TABLEAU_COLORS</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">vmin</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">cNorm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="n">scalarMap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">cNorm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">scalarMap</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">value</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)]</span>


<span class="k">def</span> <span class="nf">hex_to_RGB</span><span class="p">(</span><span class="n">hex_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Convert a hex color code into an RGB triplet</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hex_code    A string specifying a hex color code</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    RGB         A 3-element RGB vector</span>

<span class="sd">    """</span>

    <span class="n">hex_code</span> <span class="o">=</span> <span class="n">hex_code</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">'#'</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_code</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>


<span class="k">def</span> <span class="nf">is_valid_hex</span><span class="p">(</span><span class="n">hex_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Determine whether a string is a valid hex color code</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hex_code    A string</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    True is hex_code is a valid hex color code. Else False</span>

<span class="sd">    """</span>

    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'^#(?:[0-9a-fA-F]{3}){1,2}$'</span><span class="p">,</span> <span class="n">hex_code</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>


<span class="k">def</span> <span class="nf">prepare_color</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Convert a color, which could be in any form, into a usuable RGB tuple</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    color       A color in any form</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    RGB         A (r, g, b, a) tuple</span>
<span class="sd">    """</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

        <span class="c1"># if it is a simple hex color code, convert to RGB and return</span>
        <span class="k">if</span> <span class="n">is_valid_hex</span><span class="p">(</span><span class="n">color</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">hex_to_RGB</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]))</span>

        <span class="c1"># if it is a preset matplotlib color, return the RGB code associated</span>
        <span class="k">elif</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">hex_to_RGB</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'{} is not a valid color'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>

        <span class="c1"># RGB tuple - add alpha</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]))</span>

        <span class="c1"># nothing to do</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="o">*</span><span class="n">color</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Invalid color tuple. Must be RGB(A) but has length {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)))</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">color</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'color must be a string, tuple or pygame color'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">color_mapper</span><span class="p">(</span><span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">vmin</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return a function that maps floats between vmin and vmax based on a chosen</span>
<span class="sd">    color map</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cmap        A valid matplotlib color map string</span>
<span class="sd">    vmin        The minimum float value</span>
<span class="sd">    vmax        The maximum float value</span>
<span class="sd">    alpha       Alpha</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A function that takes a single value and outputs a color</span>

<span class="sd">    """</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">cNorm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="n">scalarMap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">cNorm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mapper</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        This is the function that gets returned</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value       A number between vmin and vmax</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An RGB color</span>

<span class="sd">        """</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">scalarMap</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">255</span> <span class="o">*</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">alpha</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">out</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">255</span>
            <span class="n">out</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span>
            <span class="k">return</span> <span class="n">out</span>

    <span class="k">return</span> <span class="n">mapper</span>

<span class="k">class</span> <span class="nc">Screen</span><span class="p">:</span>

    <span class="sd">"""</span>
<span class="sd">    Screen class.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">),</span> <span class="n">xlim</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ylim</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">background</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">frame_rate</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Initialise a Screen object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size          Screen size in pixels (length, height)</span>
<span class="sd">        xlim          The x-limits. (left, right)</span>
<span class="sd">        ylim          The y-limits. (bottom, top)</span>
<span class="sd">        screen_color  The screen color</span>
<span class="sd">        """</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">prepare_color</span><span class="p">(</span><span class="n">background</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CLICKED</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_mouse_position</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRAW_MODE</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolated_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_line</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_lines</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame_rate</span> <span class="o">=</span> <span class="n">frame_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>

        <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="s1">'Comic Sans MS'</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="k">def</span> <span class="nf">draw_cricle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

        <span class="c1"># pygame.draw.circle(self.canvas, color, self.xy_to_pix(pos), radius)</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">gfxdraw</span><span class="o">.</span><span class="n">filled_circle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_to_pix</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">xy_to_pix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>

        <span class="n">px</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">py</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span>

    <span class="k">def</span> <span class="nf">pix_to_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">xy_array_to_pix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>

        <span class="n">px</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">py</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Plot a curve, similar to pyplot.plot</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x       numpy array (n, ) holding x values to plot at</span>
<span class="sd">        y       numpy array (n, ) holding y values to plot</span>
<span class="sd">        color   the line color</span>
<span class="sd">        width   the line width in pixels</span>

<span class="sd">        """</span>

        <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">prepare_color</span><span class="p">(</span><span class="n">color</span><span class="p">),</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_array_to_pix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])),</span> <span class="n">width</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_to_pix</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_mouse_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_to_xy</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">handle_zooming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Handle zooming, triggered by a mouse roll</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event       The zoom event</span>

<span class="sd">        """</span>

        <span class="c1"># the zoom factor</span>
        <span class="n">zoom</span> <span class="o">=</span> <span class="mf">0.05</span>

        <span class="c1"># zoom in</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">zoom</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">+</span> <span class="n">zoom</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">zoom</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">+</span> <span class="n">zoom</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># zoom out</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zoom</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">-</span> <span class="n">zoom</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zoom</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">-</span> <span class="n">zoom</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">handle_panning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Handle panning, triggered by dragging the mouse</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CLICKED</span><span class="p">:</span>
            <span class="n">pos_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_mouse_position</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mouse_position</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">+=</span> <span class="n">pos_change</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">+=</span> <span class="n">pos_change</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_mouse_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mouse_position</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">handle_drawing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CLICKED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mouse_position</span><span class="p">())</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_lines</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_line</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_mouse_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mouse_position</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">plot_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">pad_left</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">pad_right</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">pad_top</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">pad_bottom</span> <span class="o">=</span> <span class="mf">0.2</span>

        <span class="n">n_x_ticks</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">n_y_ticks</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pad_left</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pad_right</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pad_bottom</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pad_top</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>

        <span class="c1"># x axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]))</span>
        <span class="c1"># y axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">]))</span>

        <span class="c1"># x-ticks</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">n_x_ticks</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y0</span> <span class="o">-</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">f</span><span class="s1">'{x:.2g}'</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">))</span>

        <span class="c1"># y-ticks</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">n_y_ticks</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span> <span class="o">-</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">f</span><span class="s1">'{y:.2g}'</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="mf">0.04</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">))</span>

        <span class="c1"># axis labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="p">((</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="p">(</span><span class="n">pad_bottom</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">pad_left</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">(</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>

            <span class="c1"># if we exit</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

            <span class="c1"># handle zooming</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEBUTTONDOWN</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_zooming</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>

                <span class="c1"># enter draw mode</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRAW_MODE</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">DRAW_MODE</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">DRAW_MODE</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># handle panning</span>
        <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRAW_MODE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_panning</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_drawing</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CLICKED</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CLICKED</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRAW_MODE</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_line</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">n_lines</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CLICKED</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">pressed_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">())</span>

        <span class="c1"># if we hit ctrl+z, remove last line</span>
        <span class="k">if</span> <span class="mi">122</span> <span class="ow">in</span> <span class="n">pressed_keys</span> <span class="ow">and</span> <span class="mi">306</span> <span class="ow">in</span> <span class="n">pressed_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># quit if we hit esc</span>
        <span class="k">if</span> <span class="mi">27</span> <span class="ow">in</span> <span class="n">pressed_keys</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="c1"># draw lines</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_axis</span><span class="p">()</span>

        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_rate</span><span class="p">)</span>


<span class="n">FRAME_RATE</span> <span class="o">=</span> <span class="mi">30</span>     <span class="c1"># frames per second</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">30</span>       <span class="c1"># animation duration in seconds</span>

<span class="n">I</span> <span class="o">=</span> <span class="mi">1j</span>

<span class="n">presets</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.42</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.40</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.03</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span>  <span class="mf">0.28</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.55</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span>  <span class="mf">0.40</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.0249</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span>  <span class="mf">0.65</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span>  <span class="mf">0.7</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>

           <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.400</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.400001</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.7</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.29</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">130</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.021</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.0215</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span>  <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.10810076</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.10810077</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.189</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.188</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">**</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.67</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.19501</span><span class="p">,</span>
               <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.19502</span><span class="p">,</span>
               <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span>
               <span class="s1">'x1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span>
               <span class="s1">'y1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
               <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
               <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
               <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
               <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">10</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.788</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.786</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">11</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00437</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00434</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">t</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">12</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.035</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">13</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.37</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">14</span> <span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">15</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">1.7605</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">1.760502</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">16</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.144</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.146</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">2.1</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">17</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                 <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                 <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="s1">'x1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span>
                 <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                 <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
                 <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">599</span><span class="p">,</span>
                 <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">18</span> <span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span><span class="o">-</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span><span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">599</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">19</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.53</span><span class="p">,</span>
                 <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span>
                 <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                 <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                 <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span>
                 <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">,</span>
                 <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">y</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="p">,</span>
                 <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">599</span><span class="p">,</span>
                 <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">20</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="s1">'t1'</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                 <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                 <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                 <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span><span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">t</span> <span class="p">,</span>
                 <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>  <span class="p">,</span>
                 <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
                 <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>

           <span class="mi">20</span><span class="p">:</span> <span class="p">{</span><span class="s1">'t0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">'t1'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="s1">'x0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">,</span>
                <span class="s1">'x1'</span><span class="p">:</span> <span class="mf">1.15</span><span class="p">,</span>
                <span class="s1">'y0'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>
                <span class="s1">'y1'</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span>
                <span class="s1">'x_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="p">,</span>
                <span class="s1">'y_'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="p">,</span>
                <span class="s1">'n_iters'</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
                <span class="s1">'trail_length'</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s1">'hsv'</span><span class="p">):</span>

    <span class="n">preset</span> <span class="o">=</span> <span class="n">presets</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'t0'</span><span class="p">],</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'t1'</span><span class="p">]</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">Screen</span><span class="p">((</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">preset</span><span class="p">[</span><span class="s1">'x0'</span><span class="p">],</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'x1'</span><span class="p">]),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">preset</span><span class="p">[</span><span class="s1">'y0'</span><span class="p">],</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'y1'</span><span class="p">]),</span> <span class="n">frame_rate</span><span class="o">=</span><span class="n">FRAME_RATE</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">next_x</span><span class="p">,</span> <span class="n">next_y</span> <span class="o">=</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'x_'</span><span class="p">],</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'y_'</span><span class="p">]</span>

    <span class="n">n_iters</span> <span class="o">=</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'n_iters'</span><span class="p">]</span>
    <span class="n">trail_length</span> <span class="o">=</span> <span class="n">preset</span><span class="p">[</span><span class="s1">'trail_length'</span><span class="p">]</span>

    <span class="c1"># animation time in seconds</span>
    <span class="n">n_frames</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">*</span> <span class="n">FRAME_RATE</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_frames</span><span class="p">,</span> <span class="n">n_iters</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span>
    <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iters</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">output</span><span class="p">[:,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_x</span><span class="p">(</span><span class="n">output</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ts</span><span class="p">)</span>
        <span class="n">output</span><span class="p">[:,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_y</span><span class="p">(</span><span class="n">output</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ts</span><span class="p">)</span>

    <span class="n">mappers</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">color_map</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">n_iters</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="n">trail_length</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trail_length</span><span class="p">)]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[[</span><span class="n">mappers</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iters</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trail_length</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>

        <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">screen</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">screen</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">screen</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">screen</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">points</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">trail_length</span><span class="p">:</span><span class="n">j</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]):</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">X</span> <span class="o">&lt;</span> <span class="n">x1</span><span class="p">,</span> <span class="n">X</span> <span class="o">&gt;</span> <span class="n">x0</span><span class="p">,</span> <span class="n">Y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">,</span> <span class="n">Y</span> <span class="o">&gt;</span> <span class="n">y0</span><span class="p">]):</span>
                    <span class="n">screen</span><span class="o">.</span><span class="n">draw_cricle</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="n">screen</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">f</span><span class="s1">'t = {t:.9g}'</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>



<span class="n">run</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s1">'CMRmap_r'</span><span class="p">)</span>


<span class="s1">' Accent_r, Blues, Blues_r, BrBG, BrBG_r, BuGn, BuGn_r, BuPu, BuPu_r, CMRmap, CMRmap_r, Dark2, Dark2_r, GnBu, GnBu_r, Greens, Greens_r, Greys, Greys_r, OrRd, OrRd_r, Oranges, Oranges_r, PRGn, PRGn_r, Paired, Paired_r, Pastel1, Pastel1_r, Pastel2, Pastel2_r, PiYG, PiYG_r, PuBu, PuBuGn, PuBuGn_r, PuBu_r, PuOr, PuOr_r, PuRd, PuRd_r, Purples, Purples_r, RdBu, RdBu_r, RdGy, RdGy_r, RdPu, RdPu_r, RdYlBu, RdYlBu_r, RdYlGn, RdYlGn_r, Reds, Reds_r, Set1, Set1_r, Set2, Set2_r, Set3, Set3_r, Spectral, Spectral_r, Wistia, Wistia_r, YlGn, YlGnBu, YlGnBu_r, YlGn_r, YlOrBr, YlOrBr_r, YlOrRd, YlOrRd_r, afmhot, afmhot_r, autumn, autumn_r, binary, binary_r, bone, bone_r, brg, brg_r, bwr, bwr_r, cividis, cividis_r, cool, cool_r, coolwarm, coolwarm_r, copper, copper_r, cubehelix, cubehelix_r, flag, flag_r, gist_earth, gist_earth_r, gist_gray, gist_gray_r, gist_heat, gist_heat_r, gist_ncar, gist_ncar_r, gist_rainbow, gist_rainbow_r, gist_stern, gist_stern_r, gist_yarg, gist_yarg_r, gnuplot, gnuplot2, gnuplot2_r, gnuplot_r, gray, gray_r, hot, hot_r, hsv, hsv_r, inferno, inferno_r, jet, jet_r, magma, magma_r, nipy_spectral, nipy_spectral_r, ocean, ocean_r, pink, pink_r, plasma, plasma_r, prism, prism_r, rainbow, rainbow_r, seismic, seismic_r, spring, spring_r, summer, summer_r, tab10, tab10_r, tab20, tab20_r, tab20b, tab20b_r, tab20c, tab20c_r, terrain, terrain_r, twilight, twilight_r, twilight_shifted, twilight_shifted_r, viridis, viridis_r, winter, winter_r'</span>
</pre>
       </div>
       <script type="text/javascript">
        if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js','color.js','mhchem.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'red ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
       </script>
      </section>
      <div id="disqus_thread">
      </div>
      <script>
       /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://but-is-it-data-science.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
      </script>
      <noscript>
       Please enable JavaScript to view the
       <a href="https://disqus.com/?ref_noscript">
        comments powered by Disqus.
       </a>
      </noscript>
      <section class="post-info">
       <div class="post-share">
        <a class="twitter" href="https://twitter.com/share?text=The Chaos Equations&amp;url=/the-chaos-eqns.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
         <i class="ic ic-twitter">
         </i>
         <span class="hidden">
          Twitter
         </span>
        </a>
        <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=/the-chaos-eqns.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
         <i class="ic ic-facebook">
         </i>
         <span class="hidden">
          Facebook
         </span>
        </a>
        <a class="googleplus" href="https://plus.google.com/share?url=/the-chaos-eqns.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
         <i class="ic ic-googleplus">
         </i>
         <span class="hidden">
          Google+
         </span>
        </a>
        <div class="clear">
        </div>
       </div>
       <aside class="post-tags">
        <a href="/tag/maths.html">
         maths
        </a>
        <a href="/tag/chaos.html">
         chaos
        </a>
        <a href="/tag/python.html">
         python
        </a>
        <a href="/tag/pygame.html">
         pygame
        </a>
        <a href="/tag/animation.html">
         animation
        </a>
       </aside>
       <div class="clear">
       </div>
      </section>
      <aside class="post-nav">
       <div class="clear">
       </div>
      </aside>
     </div>
    </article>
   </main>
   <!-- TODO : Body class -->
   <div class="" id="body-class" style="display: none;">
   </div>
   <footer id="footer">
    <div class="inner">
     <section class="credits">
      <span class="credits-theme">
       Theme
       <a href="https://github.com/arulrajnet/attila" rel="nofollow">
        Attila
       </a>
      </span>
      <span class="credits-software">
       Published with
       <a href="https://github.com/getpelican/pelican" rel="nofollow">
        Pelican
       </a>
      </span>
     </section>
    </div>
   </footer>
  </section>
  <script src="/theme/js/script.js" type="text/javascript">
  </script>
 </body>
</html>